# 多态怎么实现的

多态是面向对象编程中的一个重要概念，它允许不同类型的对象对同一个接口产生不同的行为。多态性通过继承和虚函数实现，具体实现多态性的关键包括以下几个步骤：

1.定义基类：首先定义一个基类，它包含虚函数，这些虚函数在派生类中可以被重写。基类是一个抽象的概念，用于定义共享的接口和行为。
2.派生类继承基类：创建派生类，它从基类派生而来。派生类继承了基类的属性和行为，并可以添加额外的特定于自己的属性和行为。
3.重写虚函数：在派生类中重写（Override）基类的虚函数。重写的函数具有与基类函数相同的签名，但可以提供不同的实现。这样做的关键是在基类的虚函数前面使用"virtual"关键字。
4.使用基类指针或引用：可以通过基类指针或引用来引用派生类的对象。这样可以实现多态性，即使用相同的函数调用接口，实际上却执行不同派生类中定义的函数。
5.运行时多态：在运行时根据对象的实际类型确定调用哪个函数。利用虚函数表（vtable）的机制，编译器可以在运行时动态地调用正确的函数实现。

通过以上步骤，多态性可以通过基类和派生类之间的继承和虚函数的重写来实现。多态性使得代码更加灵活和可扩展，允许在运行时根据对象的实际类型决定调用哪个函数，从而实现不同对象的不同行为。





# 多态的实现为什么只能用指针和引用

多态的实现主要依赖于基类指针或引用来访问派生类的对象，而不能直接使用对象本身。这是因为多态性涉及到运行时的类型确定和函数调用的动态绑定，而对象的静态类型是在编译时确定的。
使用指针或引用的主要原因包括：

1.大小和类型的不确定性：派生类的大小和类型可能不同于基类，因此在编译时无法确定一个对象的准确大小和类型。但是，通过基类指针或引用，可以将其指向或引用派生类的对象，并根据实际的对象类型进行动态绑定。
2.避免对象切割（Object slicing）：如果直接使用基类对象来访问派生类的成员，可能会发生对象切割的问题。对象切割是指将派生类对象赋值给基类对象时，派生类特有的成员变量和行为会被丢失。使用指针或引用可以避免这种情况，因为指针或引用仍然保留派生类对象的类型信息。
3.动态绑定和运行时决策：多态的关键是在运行时根据对象的实际类型确定调用哪个函数。通过基类指针或引用，可以在运行时动态地查找和调用相应的派生类函数。这样可以实现不同对象的不同行为，并实现动态决策的能力。

综上所述，使用指针或引用是为了实现多态性的动态绑定和类型识别所必需的。它们提供了灵活性和可扩展性，允许在运行时根据对象的实际类型确定调用哪个函数，从而实现多态性的特性。